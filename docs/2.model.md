# 2. 模型设计

## 2.1 权限系统

```mermaid
erDiagram
Role ||--o{ UserRole : "用户角色关联"
User ||--o{ UserRole : "用户角色关联"
Permission ||--o{ RolePermission : "角色权限关联"
Role ||--o{ RolePermission : "角色权限关联"

User {
  int id PK
  string username "用户名"
  string password "密码"
  string avatar "头像"
  string email "邮箱"
  string phone "手机号"
  int status "状态"
}

Role {
  int id PK
  string name "角色名"
  string description "描述"
}

UserRole {
  int id PK
  int user_id FK
  int role_id FK
}

Permission {
  int id PK
  string name "权限名"
  string description "描述"
}

RolePermission {
  int id PK
  int role_id FK
  int permission_id FK
}
```

## 2.2 用户群组系统

```mermaid
erDiagram
User ||--o{ UserFriend : "用户好友"
User ||--o{ UserFriend : "被关联的好友"
User ||--o{ UserGroup : "用户群关联"
Group ||--o{ UserGroup : "用户群关联"

Group {
  int id PK
  string name "群名"
  string avatar "头像"
  string description "描述"
  int status "状态"
}

UserGroup {
  int id PK
  int user_id FK
  int group_id FK
  int group_role "群角色"
  int status "状态"
}

UserFriend {
  int id PK
  int user_id FK
  int friend_id FK
  int status "状态"
}
```

## 2.3 用户申请系统

用户的好友或加群申请：

```mermaid
erDiagram
User ||--o{ UserApply : "申请添加好友"
User ||--o{ UserApply : "被申请用户"

UserApply {
  int id PK
  int user_id FK "申请用户 ID"
  int target_id FK "被申请用户 ID"
  int type "类型"
  string content "内容"
  string answer "安全问题回答"
  int status "状态"
  datetime create_time "创建时间"
}
```

## 2.4 用户消息系统

```mermaid
erDiagram
User ||--o{ Message : "发送消息"
User ||--o{ Room: "用户房间"

Message {
  int id PK
  int user_id FK "用户 ID"
  int room_id FK "房间 ID"
  string content "内容"
  int status "状态"
  datetime create_time "创建时间"
}

Room {
  int id PK
  int user_id FK
  int room_id FK
  int status "状态"
}
```
